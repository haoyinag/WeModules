import { defineConfig } from 'dumi';

// const BundleAnalyzerPlugin = require('webpack-bundle-analyzer')
//   .BundleAnalyzerPlugin;

import chainWebpackPro from './config/chainWebpack';

import navs from './src/navs';
import menus from './src/menu';
// import routes from './src/router';

const env = process.env.NODE_ENV;

let config: any = {
  base: '/',
  publicPath: '/',
  exportStatic: {}, // 将所有路由输出为 HTML 目录结构，以免刷新页面时 404
  mode: 'site',
  title: 'Usi',

  favicon:
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyODE3QjZBN0NBRUYxMUU5OTg3MDhBODhCMzk4RDJCRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyODE3QjZBOENBRUYxMUU5OTg3MDhBODhCMzk4RDJCRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjI4MTdCNkE1Q0FFRjExRTk5ODcwOEE4OEIzOThEMkJGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI4MTdCNkE2Q0FFRjExRTk5ODcwOEE4OEIzOThEMkJGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+5O/+uQAAA+1JREFUeNrsWElPFEEU7qrumt4YjOgYRASiuCFqJMQQF5y4gSCiFw9eNdGz8eDJiz/Ai7/DoILiFvc1Gg9uaKIILjjGgOss3VVdvqIaMKjTPQMjFzpz6Kqu7lfvve/73qtBAxublKm4sDJF17Th3C7O835Vy9+o4yrcQ6qqEJLHDvL0mKfTRnz9zGNHyfIans78L489D5lm9MA+rbICWebgoSPCY4QK7jG4q69tAKtwr6+pJzXLuOMUPtScI02zdu8cCZlm7WxVKCu4YZ7JkJW1et2q0Rljc1ytKFdcWmCPPW7talPw2Is4WmQ2b4UNFdAwUEhbUGVsXD9u3mrdjmeVKIwVzGPXMVubAdLinjH3eY+cVstKYTcAusIYplSdE4OoypHz5BkQiSU++U7vahMbCq0kOCdYGZviamy2HCY7z9E3/anui3JIapZG6uvCO41zEA3bNtt3yBH7MJC5dhPPKE6dPc+TKd/p3W1CRsI5jXMQjYY1pHrBiLvd3uAQMgza25e+dkNOigVLl4QUk9Aeq2Oi4X3/kTp/AemR4Xmc7OiEeMAtIkSISThs43DuZiIrluv1q+Uwffkq638vihIYi0Scx0+ch498MdkSV8vnAQwnyWOPWe2tClRA2ASlydNdoJT+I0gqpT87zvifKy42m7aEqVchDLuuVlVpxBt9Ft1/4D7rQREy+hwynbl9j77u9SG2YzsumRkYcByCRY7Z0oRsSw5/njwtMvp7EcSYf/+RPNXlg2Femd64LtDpIMOM4dhsq8Vvgd2el879h8g0xq1Chg6J9wYH5dAGMTH07LzCgaJhtWzDc2I+i0518lTyLzVf01giMSYmtTX6uobsTgd1IFjFJSXu8xcCYUND6avXIaN/XQjwhmhDU4B0HXaGYzEla0uCgk8SoxkFvEA1xDhLXmTK/QYU44n1XNIqfAjolL2xggWwTPZfGE+42Rs2BvQVsoAQyJMk9J+B4a6rME/RVETI5HSZ8MXowf24yE5fuuK+6vW+fhUGhEwCbsE5JKAQtcniRXp8Ay6Ofjt+Yjzl8jHsOKR6ob13D/TuINds4CPt66dv33lDX4DioCSgVmp5GYiMBmI5bAzKRubW3X/BMKxhaHeEgIyEV51bCj8oRFlegaYgc/NOQNE5XFUdkGKMRWw5B15h2w5gAFDu+q1UR6f36XN2fIWgE0Kig6QUJIwsWRxZWatVzAddhJSLUsGYl0yygQTrf+s8fur2vGAfEwKDQrkmyOPfaCpwC707IaJIqAK9Au0wDwc41wGIIaKNFa5JOzuBJZlpKcKUcll3Bcc0JUKUXK68Dm2SJzme0qb/ipgqw78EGAA7h5TvKBKCfAAAAABJRU5ErkJggg==',
  logo:
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyODE3QjZBN0NBRUYxMUU5OTg3MDhBODhCMzk4RDJCRiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyODE3QjZBOENBRUYxMUU5OTg3MDhBODhCMzk4RDJCRiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjI4MTdCNkE1Q0FFRjExRTk5ODcwOEE4OEIzOThEMkJGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI4MTdCNkE2Q0FFRjExRTk5ODcwOEE4OEIzOThEMkJGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+5O/+uQAAA+1JREFUeNrsWElPFEEU7qrumt4YjOgYRASiuCFqJMQQF5y4gSCiFw9eNdGz8eDJiz/Ai7/DoILiFvc1Gg9uaKIILjjGgOss3VVdvqIaMKjTPQMjFzpz6Kqu7lfvve/73qtBAxublKm4sDJF17Th3C7O835Vy9+o4yrcQ6qqEJLHDvL0mKfTRnz9zGNHyfIans78L489D5lm9MA+rbICWebgoSPCY4QK7jG4q69tAKtwr6+pJzXLuOMUPtScI02zdu8cCZlm7WxVKCu4YZ7JkJW1et2q0Rljc1ytKFdcWmCPPW7talPw2Is4WmQ2b4UNFdAwUEhbUGVsXD9u3mrdjmeVKIwVzGPXMVubAdLinjH3eY+cVstKYTcAusIYplSdE4OoypHz5BkQiSU++U7vahMbCq0kOCdYGZviamy2HCY7z9E3/anui3JIapZG6uvCO41zEA3bNtt3yBH7MJC5dhPPKE6dPc+TKd/p3W1CRsI5jXMQjYY1pHrBiLvd3uAQMgza25e+dkNOigVLl4QUk9Aeq2Oi4X3/kTp/AemR4Xmc7OiEeMAtIkSISThs43DuZiIrluv1q+Uwffkq638vihIYi0Scx0+ch498MdkSV8vnAQwnyWOPWe2tClRA2ASlydNdoJT+I0gqpT87zvifKy42m7aEqVchDLuuVlVpxBt9Ft1/4D7rQREy+hwynbl9j77u9SG2YzsumRkYcByCRY7Z0oRsSw5/njwtMvp7EcSYf/+RPNXlg2Femd64LtDpIMOM4dhsq8Vvgd2el879h8g0xq1Chg6J9wYH5dAGMTH07LzCgaJhtWzDc2I+i0518lTyLzVf01giMSYmtTX6uobsTgd1IFjFJSXu8xcCYUND6avXIaN/XQjwhmhDU4B0HXaGYzEla0uCgk8SoxkFvEA1xDhLXmTK/QYU44n1XNIqfAjolL2xggWwTPZfGE+42Rs2BvQVsoAQyJMk9J+B4a6rME/RVETI5HSZ8MXowf24yE5fuuK+6vW+fhUGhEwCbsE5JKAQtcniRXp8Ay6Ofjt+Yjzl8jHsOKR6ob13D/TuINds4CPt66dv33lDX4DioCSgVmp5GYiMBmI5bAzKRubW3X/BMKxhaHeEgIyEV51bCj8oRFlegaYgc/NOQNE5XFUdkGKMRWw5B15h2w5gAFDu+q1UR6f36XN2fIWgE0Kig6QUJIwsWRxZWatVzAddhJSLUsGYl0yygQTrf+s8fur2vGAfEwKDQrkmyOPfaCpwC707IaJIqAK9Au0wDwc41wGIIaKNFa5JOzuBJZlpKcKUcll3Bcc0JUKUXK68Dm2SJzme0qb/ipgqw78EGAA7h5TvKBKCfAAAAABJRU5ErkJggg==',
  // favicon:
  //   'https://user-images.githubusercontent.com/9554297/83762004-a0761b00-a6a9-11ea-83b4-9c8ff721d4b8.png',
  // logo:
  //   'https://user-images.githubusercontent.com/9554297/83762004-a0761b00-a6a9-11ea-83b4-9c8ff721d4b8.png',
  outputPath: 'dist',
  menus,
  navs,
  // more config: https://d.umijs.org/config
};

if (env === 'production') {
  config = {
    ...config,
    // plugins: [new BundleAnalyzerPlugin()],
    chunks: ['vendors', 'umi'],
    chainWebpack: (config: any) => chainWebpackPro(config),
  };
}

export default defineConfig(config);
